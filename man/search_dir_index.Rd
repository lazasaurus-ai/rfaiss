% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/search_text.R
\name{search_dir_index}
\alias{search_dir_index}
\title{Search a saved directory index with text queries}
\usage{
search_dir_index(
  index_path,
  manifest_path,
  queries,
  k = 5L,
  model = "sentence-transformers/all-MiniLM-L6-v2",
  python = Sys.getenv("RETICULATE_PYTHON", unset = NA_character_),
  use_cosine = FALSE,
  rerank = c("faiss", "emb", "mmr", "llm"),
  embeddings_path = NULL,
  mmr_lambda = 0.5,
  llm_chat = NULL
)
}
\arguments{
\item{index_path}{path to .faiss file}

\item{manifest_path}{path to corresponding _manifest.rds}

\item{queries}{character vector}

\item{k}{neighbors per query}

\item{model}{embedding model (should match one used to build)}

\item{python}{optional python binary path (character) or NULL. If omitted/NA, we pass NULL to reticulate.}

\item{use_cosine}{Logical; if TRUE will call index_search_cosine() (default FALSE). Kept for backwards compatibility.}

\item{rerank}{One of "faiss" (default), "emb", "mmr", "llm"}

\item{embeddings_path}{optional path to saved embeddings.rds (if NULL we'll try to infer from index_path)}

\item{mmr_lambda}{lambda for MMR (0..1)}

\item{llm_chat}{optional ellmer chat object (required when rerank = "llm")}
}
\value{
data.frame with one row per query*k result, columns: query_id, rank, distance, file, chunk_id, snippet
}
\description{
Compatible with the previous API but adds optional reranking strategies:
\itemize{
\item rerank = "faiss" (default): use FAISS results as-is
\item rerank = "emb": rerank FAISS top-k by exact saved-embeddings cosine
\item rerank = "mmr": MMR rerank using saved embeddings (reduces redundancy)
\item rerank = "llm": use an ellmer chat object as a reranker (requires llm_chat)
}
}
